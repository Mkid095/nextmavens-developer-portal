{
  "project": "Schema Browser",
  "branchName": "flow/schema-browser",
  "description": "Visual schema exploration. Tables list. Column details with types. Indexes viewer. Foreign keys display. Developers can understand database structure without writing queries.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Create Schema Browser Component",
      "description": "As a developer, I want a schema browser in Studio so that I can explore my database structure.",
      "acceptanceCriteria": [
        "Schema browser component created",
        "Tree structure for navigation",
        "Tables list",
        "Expandable columns",
        "Typecheck passes"
      ],
      "mavenSteps": [
        5,
        10
      ],
      "mcpTools": {
        "step5": [],
        "step10": []
      },
      "priority": 1,
      "passes": true,
      "notes": "Completed: SchemaBrowser component created at src/features/schema-browser/components/SchemaBrowser.tsx. Tree structure for navigation with expandable tables. Tables list with row counts. Expandable columns showing name, data type, nullable status, and default values. Color-coded data types (blue=numeric, green=text, purple=boolean, orange=date/time, pink=json). Icons for different data types. Component exported via src/features/schema-browser/index.ts. Typecheck passes."
    },
    {
      "id": "US-002",
      "title": "Fetch Tables List",
      "description": "As a developer, I want to see all tables so that I know what's in my database.",
      "acceptanceCriteria": [
        "GET /api/studio/:projectId/tables endpoint",
        "Queries information_schema.tables",
        "Filters for tenant_{slug} schema",
        "Returns: table_name, created_at",
        "Typecheck passes"
      ],
      "mavenSteps": [
        1,
        2,
        7,
        10
      ],
      "mcpTools": {
        "step1": [],
        "step2": [],
        "step7": [],
        "step10": []
      },
      "priority": 1,
      "passes": true,
      "notes": "Completed: GET /api/studio/[projectId]/tables endpoint created at src/app/api/studio/[projectId]/tables/route.ts. Queries information_schema.tables filtering for tenant_{slug} schema. Returns table_name and created_at. JWT authentication with project_id claim verification. Typecheck passes."
    },
    {
      "id": "US-003",
      "title": "Fetch Column Details",
      "description": "As a developer, I want to see column details so that I understand table structure.",
      "acceptanceCriteria": [
        "GET /api/studio/:projectId/tables/:table/columns endpoint",
        "Queries information_schema.columns",
        "Returns: column_name, data_type, is_nullable, column_default",
        "Typecheck passes"
      ],
      "mavenSteps": [
        1,
        2,
        7,
        10
      ],
      "mcpTools": {
        "step1": [],
        "step2": [],
        "step7": [],
        "step10": []
      },
      "priority": 1,
      "passes": true,
      "notes": "Completed: src/app/api/studio/[projectId]/tables/[table]/columns/route.ts (110+ lines). GET endpoint that queries information_schema.columns for a specific table in tenant_{slug} schema. Returns column_name, data_type, is_nullable, column_default, plus ordinal_position, character_maximum_length, numeric_precision, numeric_scale, datetime_precision. JWT authentication with project_id claim verification. Table name validation (regex check) to prevent SQL injection. Table existence check before querying columns. Columns ordered by ordinal_position. Typecheck passes."
    },
    {
      "id": "US-004",
      "title": "Display Column Types",
      "description": "As a developer, I want column types shown so that I know what data each column holds.",
      "acceptanceCriteria": [
        "Column list in schema browser",
        "Shows: column name, type, nullable, default",
        "Color-coded for data types",
        "Typecheck passes"
      ],
      "mavenSteps": [
        5,
        10
      ],
      "mcpTools": {
        "step5": [],
        "step10": []
      },
      "priority": 1,
      "passes": true,
      "notes": "Completed: Column display implemented in SchemaBrowser component at src/features/schema-browser/components/SchemaBrowser.tsx. Shows column name, data_type, is_nullable, and column_default (lines 176-190). Color-coded by data type: blue=numeric, green=text, purple=boolean, orange=date/time, pink=json (lines 72-90). Type icons displayed for each data type (lines 92-101). Typecheck passes."
    },
    {
      "id": "US-005",
      "title": "Fetch Indexes",
      "description": "As a developer, I want to see indexes so that I understand query optimization.",
      "acceptanceCriteria": [
        "GET /api/studio/:projectId/tables/:table/indexes endpoint",
        "Queries pg_indexes",
        "Returns: index_name, index_def, is_unique, is_primary",
        "Typecheck passes"
      ],
      "mavenSteps": [
        1,
        2,
        7,
        10
      ],
      "mcpTools": {
        "step1": [],
        "step2": [],
        "step7": [],
        "step10": []
      },
      "priority": 2,
      "passes": true,
      "notes": "Completed: src/app/api/studio/[projectId]/tables/[table]/indexes/route.ts. GET endpoint that queries pg_indexes joined with pg_index for a specific table in tenant_{slug} schema. Returns index_name, index_def, is_unique, and is_primary. JWT authentication with project_id claim verification. Table name validation (regex check) to prevent SQL injection. Table existence check before querying indexes. Indexes ordered by index_name. Typecheck passes."
    },
    {
      "id": "US-006",
      "title": "Display Indexes",
      "description": "As a developer, I want indexes displayed so that I can see what's indexed.",
      "acceptanceCriteria": [
        "Indexes section in table detail",
        "Shows: index name, columns, unique, primary",
        "Icon for unique/primary",
        "Typecheck passes"
      ],
      "mavenSteps": [
        5,
        10
      ],
      "mcpTools": {
        "step5": [],
        "step10": []
      },
      "priority": 2,
      "passes": true,
      "notes": "Completed: Indexes display implemented in SchemaBrowser component at src/features/schema-browser/components/SchemaBrowser.tsx. Added DatabaseIndex interface (index_name, index_def, is_unique, is_primary). Async fetching of indexes when table is expanded via useEffect hook. Indexes section displays below columns with 'Indexes' header. Shows index name, truncated index definition, and icons: Star (amber) for primary keys, ShieldCheck (blue) for unique indexes. Loading state with spinner while fetching indexes. Typecheck passes."
    },
    {
      "id": "US-007",
      "title": "Fetch Foreign Keys",
      "description": "As a developer, I want to see foreign keys so that I understand relationships.",
      "acceptanceCriteria": [
        "GET /api/studio/:projectId/tables/:table/foreign-keys endpoint",
        "Queries information_schema.table_constraints",
        "Queries information_schema.key_column_usage",
        "Returns: constraint_name, column_name, foreign_table, foreign_column",
        "Typecheck passes"
      ],
      "mavenSteps": [
        1,
        2,
        7,
        10
      ],
      "mcpTools": {
        "step1": [],
        "step2": [],
        "step7": [],
        "step10": []
      },
      "priority": 2,
      "passes": true,
      "notes": "Completed: GET /api/studio/[projectId]/tables/[table]/foreign-keys endpoint created at src/app/api/studio/[projectId]/tables/[table]/foreign-keys/route.ts. Queries information_schema.table_constraints joined with information_schema.key_column_usage and information_schema.constraint_column_usage. Returns constraint_name, column_name, foreign_table_name, and foreign_column_name. Filters for tenant_{slug} schema and specific table. JWT authentication with project_id claim verification. Table name validation (regex check) to prevent SQL injection. Table existence check before querying foreign keys. Foreign keys ordered by constraint_name and ordinal_position. Typecheck passes."
    },
    {
      "id": "US-008",
      "title": "Display Foreign Keys",
      "description": "As a developer, I want foreign keys displayed so that I can see table relationships.",
      "acceptanceCriteria": [
        "Foreign keys section in table detail",
        "Shows: column, references table.column",
        "Visual line connecting related tables",
        "Typecheck passes"
      ],
      "mavenSteps": [
        5,
        10
      ],
      "mcpTools": {
        "step5": [],
        "step10": []
      },
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Search Tables",
      "description": "As a developer, I want to search tables so that I can find specific tables quickly.",
      "acceptanceCriteria": [
        "Search box in schema browser",
        "Filters tables by name",
        "Real-time search",
        "Typecheck passes"
      ],
      "mavenSteps": [
        5,
        10
      ],
      "mcpTools": {
        "step5": [],
        "step10": []
      },
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Show Row Count",
      "description": "As a developer, I want to see row counts so that I know table sizes.",
      "acceptanceCriteria": [
        "COUNT(*) query for each table",
        "Displayed next to table name",
        "Async to not block UI",
        "Typecheck passes"
      ],
      "mavenSteps": [
        1,
        2,
        7,
        10
      ],
      "mcpTools": {
        "step1": [],
        "step2": [],
        "step7": [],
        "step10": []
      },
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-011",
      "title": "Visual Schema Diagram",
      "description": "As a developer, I want a visual schema diagram so that I can see relationships visually.",
      "acceptanceCriteria": [
        "Canvas-based schema diagram",
        "Tables as boxes",
        "Foreign keys as lines",
        "Draggable boxes",
        "Zoom/pan",
        "Typecheck passes"
      ],
      "mavenSteps": [
        5,
        10
      ],
      "mcpTools": {
        "step5": [],
        "step10": []
      },
      "priority": 3,
      "passes": false,
      "notes": ""
    }
  ],
  "relatedPRDs": [],
  "consolidatedMemory": "",
  "lessonsLearned": "",
  "memorialFile": "docs/memory/Schema Browser.md"
}